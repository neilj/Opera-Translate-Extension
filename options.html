<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="lib/options.css">
  <title id="widget-title">Opera Extensions | Translate</title>
  <script type="text/javascript">
  /**
   * ---------------------------------------
   * OEX Auto Localization Library Snippet
   * ---------------------------------------
   * 
   * http://my.opera.com/richtr/blog/experimental-auto-internationalization-i18n-library-for-opera-11-extension-dev
   */
  !function( undefined ) {
		var oex = opera.extension;
		var i18nObj = function() {
			var _m = [],
				lang = 'en',
				readyTransactions = [],
				localizeTransactions = [],
				initialized = false;
			function _om ( msg ) {
				var d = msg.data, 
					s = [];
				if(!d || d.action!=='i18n_localized') return;
				for(var j in d.data) s[j] = _m[j] = d.data[j];
				if(d.id) localizeTransactions[ d.id ]( d.language, s );
				if(!initialized) {
					initialized = true;
					lang = d.language;
					for(var i = 0, l = readyTransactions.length; i < l; i++) {
						readyTransactions[ i ]( lang );
						readyTransactions = readyTransactions.splice(i, 1);
					}
				}
			}
			var _l = function( stringData, callback ) {
				if( !stringData )	{ // no data :(
					if( callback && typeof callback == 'function' )	callback( '??', stringData );
					return; 
				}
				var id = Math.floor(Math.random()*1e16),
					cb = (callback && typeof callback == 'function') ? callback : function() {};
				localizeTransactions[ id ] = cb;
				oex.postMessage({ "action": 'i18n_localize', "id": id, "messages": stringData });
			};
			var _r = function( callback ) {
				var cb = (callback && typeof callback == 'function') ? callback : function() {};
				initialized ? callback( lang ) : readyTransactions.push( cb );
			};
			var _gm = function( id, replacements ) {
				if( !_m[ id ]) return id;
				var s = _m[ id ][ "message" ];
				if(replacements)
					for(var i in replacements) s = s.replace('<string/>', replacements[i] );
				return unescape(s);
			};
			oex.messages = _m;
			oex.addEventListener('message', _om, false);
			oex.postMessage({ "action": 'i18n_load' }); 
			return {
				get ready() { return _r; }, 	 // parameters: (callback_function)
				get localize() { return _l; },   // parameters: (strings, callback_function)
				get getMessage() { return _gm; } // parameters: (message_id[, replacements])
			};
		};
		if(!oex.i18n) oex.i18n = new i18nObj();
	}();
  </script>
  <script type="text/javascript" src="lib/langs.js"></script>
  <script type="text/javascript" src="lib/options.js"></script>
  <script type="text/javascript">
// Load i18n messages on load
document.addEventListener('DOMContentLoaded', function() {
   //document.getElementById('app-name').textContent = opera.extension.i18n.getMessage('app_name');
   document.getElementById('app-for').textContent = opera.extension.i18n.getMessage('app_for');
   document.getElementById('clearPreferences').value = opera.extension.i18n.getMessage('reset_preferences_button');
   document.getElementById('translate-to').textContent = opera.extension.i18n.getMessage('translate_to');
   document.getElementById('privacy').textContent = opera.extension.i18n.getMessage('privacy_settings_header');
   document.getElementById('enable-secure-translation').textContent = opera.extension.i18n.getMessage('enable_secure_translation_header');
   document.getElementById('answer-yes').textContent = opera.extension.i18n.getMessage('answer_yes');
   document.getElementById('answer-no').textContent = opera.extension.i18n.getMessage('answer_no');
   document.getElementById('language-settings').textContent = opera.extension.i18n.getMessage('language_settings_header');
   document.getElementById('blanketPreferences').value = opera.extension.i18n.getMessage('blanket_preferences_button');
   document.getElementById('powered-by').textContent = opera.extension.i18n.getMessage('powered_by');
}, false);
  </script>
</head>
<body>
  <header>
    <img src="icons/icon_64x64.png">
    <h1 id="app-name">Translate</h1>
    <h2 id="app-for">for Opera 11</h2>
  </header>
  
  <section>
   <fieldset style="text-align:center;">
      <input type="button" id="clearPreferences" value="Reset all translation preferences">
   </fieldset>
  </section>
  
  <section>
    <h3 id="translate-to">Translate pages into</h3>
    <fieldset style="text-align:center;">
      <select id="homeLang"></select>
    </fieldset>
  </section>
  
  <section>
   <h3 id="privacy">Privacy</h3>
   <fieldset>
      <p>
         <span id="enable-secure-translation">Enable translation on secure pages?</span>
         <label id="answer-yes" for="httpsOn">Yes</label>
         <input type="radio" name="https" id="httpsOn" value="1" /> 
         <label id="answer-no" for="httpsOff">No</label>
         <input type="radio" name="https" id="httpsOff" value="0" />
      </p>
   </fieldset>
  </section>
    
  <section id="optionsList">
    <h3 id="language-settings">Change your settings per language</h3>
  </section> 
  
  <section style="margin-top:20px;">
   <fieldset style="text-align:center;">
	   <input type="button" id="blanketPreferences" value="Translate all languages automatically">
   </fieldset>
  </section>

  <footer>
    <p>Copyright &copy; MMXI Neil Jenkins and Rich Tibbett</p>
    <p><span id="powered-by">Powered by</span> <a href="http://translate.google.com">Google Translate</a></p>
  </footer>
</body>
</html>